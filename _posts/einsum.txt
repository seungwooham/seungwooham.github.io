오늘은 pytorch 코드를 작성하다보면 종종 마주치게 되는 einsum에 대해 간략히 소개해보려합니다. Einsum은 아인슈타인 표기법(Einstein summation convention)을 활용한 연산을 수행을 가능하게 하는 함수로 pytorch외에 numpy와 tensorflow 코드에서도 사용됩니다. 우리는 반복적인 연산이 있을 때 /sigma 연산 표기법을 이용하여 간략히 나타내는데, einsum 표기법은 이 /sigma를 이용한 표기과 기본적으로 같습니다. 다만 /sigma 기호가 없을 뿐입니다.
Einsum은 다양한 종류의 연산에 대해 동일한 형태로 표현할 수 있다는 장점이 있습니다. 마치 우리가 /sigma를 이용하여 다양한 연산을 표기하는 것과 같습니다. 빠른 연산 속도도 또 다른 장점입니다. 심지어 2020년 말의 업데이트를 통해서 pytorch, numpy 안의 built-in function 보다도 빠른 속도를 제공합니다. [https://github.com/pytorch/pytorch/issues/32591] (관련 pytorch issue) 하지만 처음 einsum을 접하면 불친절할 정도로 간략한 표기에 어려움을 느끼게 됩니다. 아래에 등장하는 예시들과 함께 einsum에 대해 알아봅시다.

첫 번째 예시입니다. 우리가 행렬 A와 행렬 B를 곱할 때 \Sigma를 이용하여 표기할 수 있는데, 사실 \Sigma 없이도 상식적으로 어떻게 연산이 진행되는지는 알수 있기 때문에 다음과 같이 나타낼 수 있습니다.

M_ij = \Sigma A_ik B_kj